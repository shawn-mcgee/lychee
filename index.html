<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Lychee Playground</title>
  </head>
  <body>
    <script src="lychee.js"></script>
    <style>
      textarea {
        min-width : 400px;
        min-height: 600px;
      }
    </style>

    <div id="lychee">
      <textarea id="input"></textarea>
      <textarea id="tokens" readonly></textarea>
      <textarea id="syntax" readonly></textarea>
    </div>

    <script>

      const input  = document.getElementById("input")
      const tokens = document.getElementById("tokens")
      const syntax = document.getElementById("syntax")

      fetch("./example.lychee")
        .then(r => r.text()       )
        .then(t => input.value = t)
        .then(t => update())

      function update() {
        try {
          const t = [...lex(input.value)]
          tokens.value = JSON.stringify(t, null, 2)

          try {
            const s = ast(t)
            syntax.value = JSON.stringify(s, null, 2)
          } catch (e) {
            syntax.value = e.message
          }

        } catch (e) {
          tokens.value = e.message
        }
      }

      input.oninput = update
      update()
    </script>
  </body>
</html>